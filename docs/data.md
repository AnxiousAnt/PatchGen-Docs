# Datasets Used in Training the PatchGen Model

## 1. Continued Pretraining Dataset
### Datasets: [ParZiVal04/pd-patches-14k-dataset](https://huggingface.co/datasets/ParZiVal04/Pd-patches-14k-dataset), [ParZiVal04/pd-patches-dataset (39k)](https://huggingface.co/datasets/ParZiVal04/pd-patches-dataset)

- **Total Records**: The dataset contains approximately **39,000** patches.
- **Patches Used**: A subset of 14,000 patches was used for continued pretraining.
- **Purpose**: This dataset was utilized in the first phase of the training process to expose the model to Pd syntax and structure. By doing so, the model gains a foundational understanding of how Pd patches are constructed and the common patterns used in patching.
- **Sources**: [pd-list (community archive)](https://puredata.info/community/lists), [official repository](https://git.purrdata.net/jwilkes/purr-data), [pdpatchrepo](https://forum.pdpatchrepo.info/), [bigcode/the-stack dataset](https://huggingface.co/datasets/bigcode/the-stack/tree/main/data/pure-data) ,etc.

### Structure of the Dataset:
- **Filename**: Name of the Pd patch file.
- **Patch Contents**: The actual content of the Pd patch, written in the Pure Data format.
- **Size**: Represents the size of the patch in terms of the number of records.

### Sample Data Overview:
| Column Name      | Data Type  | Description                                           |
| ---------------- | ---------- | ----------------------------------------------------- |
| `Filename`       | `object`   | The filename of the Pd patch.                         |
| `Patch Contents` | `object`   | The contents of the patch.                             |
| `Size`           | `int64`    | Size of the patch in number of records.               |

### Example:
| Filename      | Patch Contents                                                                                       | Size |
| ------------- | ---------------------------------------------------------------------------------------------------- | ---- |
| `10006_oscbank~_003.pd`  | `#N canvas 592 106 450 560 10; #X obj 80 227 \$1; #X text 110 228 number of osc~; #X obj 134 24 loadbang; #X obj 80 252 until; #X obj 40 20 bng 15 250 50 0 empty empty empty 0 -6 0 8 -262144 -1 ...` | `50` |

This dataset was instrumental in providing the base model with exposure to Pdâ€™s structural elements, such as objects, messages, and connections.

---

## 2. Instruction Fine-Tuning Dataset
### Dataset: [parzi-parzi/patch-gen-dataset-v0.8.7](https://huggingface.co/datasets/parzi-parzi/patch-gen-dataset-v0.8.7)

- **Total Records**: The dataset contains **~3,000** examples of annotated prompts and their corresponding Pd patches.
- **Purpose**: This dataset was used for **instruction fine-tuning** in the second phase of training. The goal was to teach the model to generate patches based on natural language instructions.

### Structure of the Dataset:
- **Patch File**: The name of the Pd patch file.
- **Patch Contents**: The content of the Pd patch in Pure Data format.
- **Prompt**: A natural language description or request that prompts the model to generate a specific patch.
- **Explanation**: Additional information or context explaining the functionality of the generated patch.
- **Instruction**: The task or instruction given to the model.
- **Output**: The generated patch based on the prompt.

### Sample Data Overview:
| Column Name      | Data Type  | Description                                                                            |
| ---------------- | ---------- | -------------------------------------------------------------------------------------- |
| `Patch File`     | `object`   | Name of the Pd patch file.                                                             |
| `Patch Contents` | `object`   | The content of the Pd patch.                                                           |
| `Prompt`         | `object`   | A natural language description of the task or the requested patch.     |
| `Explanation`    | `object`   | An explanation of what the patch does and its functionality.           |
| `Instruction`    | `object`   | A formal instruction given to the model for generating the patch.                      |
| `Output`         | `object`   | The patch generated by the model in response to the prompt or instruction along with the explanation.   |

### Example Row:
| Patch File    | Patch Contents                                                                                             | Prompt                                                                       | Explanation                                                                                                           | Instruction                                    | Output                                                                                                               |
| ------------- | --------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| `13_midiout.pd` | `#N canvas 755 216 575 443 10;\n#X floatatom 234 126 5 0 0 0 - - -, f 5;\n#X obj 234 158 midiout;...` | `Create a Pure Data patch that sends raw MIDI output to a specified port...` | `This patch takes two float inputs and sends raw MIDI output to a specified port, with the second inlet controlling...` | `Create a Pd patch that matches the following...` | `sure! here's the patch you requested: ``` #N canvas 755 216 575 443 10; #X floatatom 234 126 5 0 0 0 - - -, f 5; #X floatatom 273 126 5 0 0 0 - - -, f 5;`|


This dataset provided the model with annotated examples, helping it learn how to interpret natural language prompts and generate corresponding Pd patches. Each example includes a patch file, contents, and an explanation of its functionality, allowing the model to align its generation with the desired outcome.

---

## Summary
- The **Continued Pretraining Dataset** exposed the model to over 14k examples of patches, focusing on Pd syntax and structure.
- The **Instruction Fine-Tuning Dataset** provided 3k annotated examples to help the model learn how to generate Pd patches from natural language descriptions.
